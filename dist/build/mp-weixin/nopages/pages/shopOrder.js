(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["nopages/pages/shopOrder"],{3064:function(t,e,o){"use strict";o.r(e);var a=o("9bc4"),n=o("ecb7");for(var i in n)["default"].indexOf(i)<0&&function(t){o.d(e,t,(function(){return n[t]}))}(i);o("6934");var s,r=o("f0c5"),c=Object(r["a"])(n["default"],a["b"],a["c"],!1,null,"4e1af768",null,!1,a["a"],s);e["default"]=c.exports},"3bc0":function(t,e,o){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a=s(o("0c3f")),n=s(o("2018")),i=o("b703");function s(t){return t&&t.__esModule?t:{default:t}}var r,c=function(){o.e("components/topBar").then(function(){return resolve(o("ad1a"))}.bind(null,o)).catch(o.oe)},u={components:{TopBar:c},data:function(){return{latitude:null,longitude:null,address:"",markers:[],gender:1,IMG_BEFORE_URL:i.IMG_BEFORE_URL,shopId:"",detail:{},cateTags:"",tagsList:[],array:["美食","玩乐","购物"],form:{comyName:"",phone:"",time:"",times:"",address:"",shangVideo:"",shangVideoUrl:"",shangZhao1:"",shangZhao1Url:"",shangZhao2:"",shangZhao2Url:"",tags:"",remark:"",x:null,tuijianOrder:"",y:null}}},computed:{isIpx:function(){return this.$isIpx},navHeight:function(){return t.getStorageSync("navHeight")}},onLoad:function(t){this.getUserLocation(),this.shopId=t.id,this.getShop()},methods:{chooseImg:function(){var e=this;t.chooseImage({count:1,sourceType:["camera","album"],sizeType:["original","compressed"],success:function(t){var o=t.tempFilePaths[0];e.$comfun.uploadImg(o).then((function(t){var o=JSON.parse(t.data);console.log(t,"9999"),e.form.shangZhao1=i.IMG_BEFORE_URL+o.data.url,e.form.shangZhao1Url=o.data.url}))}})},chooseImgs:function(){var e=this;t.chooseImage({count:1,sourceType:["camera","album"],sizeType:["original","compressed"],success:function(t){var o=t.tempFilePaths[0];e.$comfun.uploadImg(o).then((function(t){var o=JSON.parse(t.data);e.form.shangZhao2=i.IMG_BEFORE_URL+o.data.url,e.form.shangZhao2Url=o.data.url}))}})},chooseVideo:function(){var e=this;t.chooseVideo({sourceType:["album","camera"],camera:"back",success:function(t){var o=t.tempFilePath;e.$comfun.uploadVideo(o).then((function(t){var o=JSON.parse(t.data);e.form.shangVideo=i.IMG_BEFORE_URL+o.data.url,e.form.shangVideoUrl=o.data.url}))},fail:function(t){}})},getTags:function(){var e=this;t.showLoading();var o={id:this.cateTags};this.$api.getTagsList(o).then((function(o){if(t.hideLoading(),200==o.code){var a=[];o.data.map((function(t){a.push({name:t.name,current:!1})})),e.tagsList=a,console.log(e.tagsList,"55555")}else e.$comfun.Toast(o.msg,"none")}))},addorNm:function(t){t.current=!t.current;var e=[];this.tagsList.forEach((function(t){t.current&&e.push(t.name)})),this.form.tuijianOrder=e.join(",")},getShop:function(){var e=this;t.showLoading();var o={id:this.shopId};this.$api.getShopDetail(o).then((function(o){t.hideLoading(),200==o.code&&(e.cateTags=o.data.detail.categoryId,e.getTags(),e.detail=o.data,e.form.comyName=o.data.detail.name,e.form.phone=o.data.detail.phonenumber,e.form.time=o.data.detail.beginTime,e.form.times=o.data.detail.endTime,e.form.address=o.data.detail.address)}))},getUserLocation:function(){var e=this;t.getLocation({success:function(t){(t.errMsg="getLocation:ok")&&(r=new a.default.BMapWX({ak:"o9FZ3zhus8bwG08ros15iWXqehXp7zAE"}),r.regeocoding({location:{latitude:t.latitude,longitude:t.longitude},success:function(t){console.log(t,"4444"),e.latitude=t.originalData.result.location.lat,e.longitude=t.originalData.result.location.lng,e.address=t.originalData.result.formatted_address,e.markers[0]={longitude:t.originalData.result.location.lng,latitude:t.originalData.result.location.lat,width:23,height:25,title:t.originalData.result.formatted_address,iconPath:"http://www.mingtongxa.com/wanzhuan/addressto.png"}},fail:function(t){},complete:function(t){}}))}})},openMap:function(){var e=this;t.chooseLocation({success:function(t){e.form.x=t.longitude,e.form.y=t.latitude,e.form.houseNumber=t.name;var o=e.formatLocation(t);e.form.titleAddress=o.REGION_PROVINCE+o.REGION_CITY+o.REGION_COUNTRY,e.form.address=t.address,console.log("位置名称：",t),console.log("详细地址："+t.address)}})},formatLocation:function(e){var o=/^(北京市|天津市|重庆市|上海市|香港特别行政区|澳门特别行政区)/,a=[],n={REGION_PROVINCE:null,REGION_COUNTRY:null,REGION_CITY:null,ADDRESS:null};function i(t,a){o=/^(.*?[市]|.*?地区|.*?特别行政区)(.*?[市区县])(.*?)$/g;var n=o.exec(t);a.REGION_CITY=n[1],a.REGION_COUNTRY=n[2],a.ADDRESS=n[3]+"("+e.name+")"}return(a=o.exec(e.address))?(n.REGION_PROVINCE=a[1],i(e.address,n)):(o=/^(.*?(省|自治区))(.*?)$/,a=o.exec(e.address),n.REGION_PROVINCE=a[1],i(a[3],n)),console.log(n,"555555"),this.sheng=n.REGION_PROVINCE,this.shi=n.REGION_CITY,this.qu=n.REGION_COUNTRY,t.setStorageSync("district",n.REGION_COUNTRY),t.setStorageSync("street",n.ADDRESS),this.getQuNumber(),n},getQuNumber:function(){var e=this;n.default.map((function(o){o.cities.map((function(o){o.name==e.shi&&t.setStorageSync("quhao",o.id)}))}))},gotoTijiao:function(){if(this.form.comyName)if(this.form.time)if(this.form.address)if(this.form.shangZhao1)if(this.form.shangZhao2)if(this.form.tuijianOrder){var e={shopId:this.shopId,name:this.form.comyName,phonenumber:this.form.phone,beginTime:this.form.time,endTime:this.form.times,address:this.form.address,videoUrl:this.form.shangVideoUrl,imgUrl:this.form.shangZhao1Url,iconUrl:this.form.shangZhao2Url,cates:this.form.tuijianOrder,remark:this.form.remark,x:this.form.x,y:this.form.y};t.showLoading(),this.$api.changeShopMsg(e).then((function(e){t.hideLoading(),200==e.code?(t.showToast({title:"更改成功",duration:1500}),setTimeout((function(){t.navigateBack()}),1500)):t.showToast({title:e.msg,icon:"none",duration:1500})}))}else t.showToast({title:"请添加商户标签！",icon:"none"});else t.showToast({title:"请上传商户小图！",icon:"none"});else t.showToast({title:"请上传商户照片！",icon:"none"});else t.showToast({title:"商铺位置不能为空！",icon:"none"});else t.showToast({title:"营业时间不能为空！",icon:"none"});else t.showToast({title:"商户名称不能为空！",icon:"none"})}}};e.default=u}).call(this,o("543d")["default"])},"591f":function(t,e,o){"use strict";(function(t){o("6cdc");a(o("66fd"));var e=a(o("3064"));function a(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,o("543d")["createPage"])},6934:function(t,e,o){"use strict";var a=o("9276"),n=o.n(a);n.a},9276:function(t,e,o){},"9bc4":function(t,e,o){"use strict";var a;o.d(e,"b",(function(){return n})),o.d(e,"c",(function(){return i})),o.d(e,"a",(function(){return a}));var n=function(){var t=this,e=t.$createElement;t._self._c},i=[]},ecb7:function(t,e,o){"use strict";o.r(e);var a=o("3bc0"),n=o.n(a);for(var i in a)["default"].indexOf(i)<0&&function(t){o.d(e,t,(function(){return a[t]}))}(i);e["default"]=n.a}},[["591f","common/runtime","common/vendor"]]]);