require('../common/vendor.js');(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["subpages/pages/changeQuan"],{"06ce":function(t,e,n){"use strict";(function(t){function i(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function o(t){return c(t)||u(t)||s(t)||a()}function a(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function s(t,e){if(t){if("string"===typeof t)return r(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(t,e):void 0}}function u(t){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}function c(t){if(Array.isArray(t))return r(t)}function r(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var h=function(){n.e("components/topBar").then(function(){return resolve(n("ad1a"))}.bind(null,n)).catch(n.oe)},d=function(){n.e("subpages/components/datePicker").then(function(){return resolve(n("d87a"))}.bind(null,n)).catch(n.oe)},l=function(){n.e("subpages/components/popupCheckbox").then(function(){return resolve(n("a8f0"))}.bind(null,n)).catch(n.oe)},f={components:{TopBar:h,DatePicker:d,PopupCheckbox:l},data:function(){return{time:"",times:"",date:this.getDate({format:"yyyy-mm"}),zhifuPrice:"",yuanjia:"",moneyId:null,shopId:null,status:null,noFanweiStatus:"",fanweiStatus:"",guizeStatus:"",tagsList:[{name:"周一",num:1,current:!1},{name:"周二",num:2,current:!1},{name:"周三",num:3,current:!1},{name:"周四",num:4,current:!1},{name:"周五",num:5,current:!1},{name:"周六",num:6,current:!1},{name:"周日",num:7,current:!1}],checkList:[],keyongfw:[],noKeyong:[],useShiyongS:[],startTime:"",endTime:"",shiyongRiqi:"",number:null,bukeshiyong:"",shiyongfw:"",rulerList:"",daytypeOptions:[],useTimeShow:"",totalOrder:0,saleNumber:0}},computed:{isIpx:function(){return this.$isIpx},navHeight:function(){return t.getStorageSync("navHeight")},startDate:function(){return this.getDate("start")},endDate:function(){return this.getDate("end")}},onLoad:function(t){this.shopId=t.id,this.status=t.status,this.moneyId=t.moneyId,this.noFanweiStatus="tb_voucher_".concat(this.status,"_notusable"),this.fanweiStatus="tb_voucher_".concat(this.status,"_usescope"),this.guizeStatus="tb_voucher_".concat(this.status,"_userule"),this.getMoney(),this.getGuizeList(this.noFanweiStatus),this.getGuizeLists(this.fanweiStatus),this.getGuizeListss(this.guizeStatus),this.getDateList()},methods:{getDate:function(t){var e=new Date,n=e.getFullYear(),i=e.getMonth()+1;return"start"===t?n-=60:"end"===t&&(n+=2),i=i>9?i:"0"+i,"".concat(n,"-").concat(i)},changeTime:function(t,e,n){this.time=t.target.value},changeTimes:function(t){this.times=t.target.value},getMoney:function(){var e=this;t.showLoading();var n={id:this.moneyId};this.$api.getMoneyDetail(n).then((function(n){t.hideLoading(),console.log(n.data,"5555"),e.zhifuPrice=n.data.price,e.yuanjia=n.data.amount,e.time=n.data.startTime,e.times=n.data.endTime;var i=n.data.useDayRule.split(",");e.tagsList.map((function(t){i.map((function(e){e==t.num&&(t.current=!0)}))})),e.startTime=n.data.shopDetail.beginTime,e.endTime=n.data.shopDetail.endTime,e.number=n.data.total,e.bukeshiyong=n.data.notUsable,e.shiyongfw=n.data.useScope,e.rulerList=n.data.useRule,e.totalOrder=n.data.total,e.saleNumber=n.data.saleNum}))},clearRule:function(){this.rulerList="",this.checkList.map((function(t){t.select=!1}))},addorNm:function(t){t.current=!t.current;var e=[];this.tagsList.forEach((function(t){t.current&&e.push(t.num)})),this.useShiyongS=e,this.shiyongRiqi=e.join(","),console.log(this.shiyongRiqi,"98999"),this.userShowDates()},submit:function(t){var e=[];t.length>0&&t.map((function(t){e.push(t.name)})),this.rulerList=e.join(",")},changeOr:function(){this.$refs.popupCheckbox.open()},getGuizeList:function(e){var n=this;t.showLoading();var i={ids:e};this.$api.getZidianStatus(i).then((function(e){if(t.hideLoading(),200==e.code){var i=[];e.data.map((function(t){i.push(t.dictLabel)})),n.noKeyong=i}}))},getGuizeLists:function(e){var n=this;t.showLoading();var i={ids:e};this.$api.getZidianStatus(i).then((function(e){if(t.hideLoading(),200==e.code){var i=[];e.data.map((function(t){i.push(t.dictLabel)})),n.keyongfw=i}}))},getGuizeListss:function(e){var n=this;t.showLoading();var i={ids:e};this.$api.getZidianStatus(i).then((function(e){if(t.hideLoading(),200==e.code){var i=[];e.data.map((function(t){i.push({name:t.dictLabel,select:!1})})),n.checkList=i}}))},getDateList:function(){var e=this;t.showLoading();var n={ids:"tb_coupon_daytype"};this.$api.getZidianStatus(n).then((function(n){t.hideLoading(),200==n.code&&(e.daytypeOptions=n.data)}))},userShowDates:function(){var t=this;if(this.useShiyongS){var e=o(this.useShiyongS);e.sort(),console.log(e,"5555555"),e.length>1&&e.length==e[e.length-1]-e[0]+1?(this.useTimeShow=this.daytypeOptions.find((function(t){return t.dictValue==e[0]})).dictLabel+"至"+this.daytypeOptions.find((function(t){return t.dictValue==e[e.length-1]})).dictLabel,console.log(this.useTimeShow,"65566")):(this.useTimeShow=e.map((function(e){return t.daytypeOptions.find((function(t){return t.dictValue==e})).dictLabel})).join(","),console.log(this.useTimeShow,"65566"))}},bindPickerChange:function(t){this.bukeshiyong=this.noKeyong[t.detail.value]},bindPickerChanges:function(t){this.shiyongfw=this.keyongfw[t.detail.value]},gotoAdd:function(){var e=this;if(this.zhifuPrice)if(this.yuanjia)if(this.time)if(this.times)if(this.shiyongRiqi)if(this.startTime)if(this.endTime)if(this.bukeshiyong)if(this.shiyongfw)if(this.rulerList){t.showLoading();var n=i({id:this.moneyId,name:"".concat(this.zhifuPrice,"元代").concat(this.yuanjia,"元券"),amount:this.yuanjia,price:this.zhifuPrice,startTime:this.time,endTime:this.times,useTimeRule:"".concat(this.startTime,",").concat(this.endTime),useDayRule:this.shiyongRiqi,total:this.number,type:1,useScope:this.shiyongfw,useRule:this.rulerList,notUsable:this.bukeshiyong,shopId:this.shopId,useTimeShow:"".concat(this.startTime,"-").concat(this.endTime,",").concat(this.useTimeShow),saleNum:this.saleNumber},"total",this.totalOrder);this.$api.changeDaijin(n).then((function(n){t.hideLoading(),200==n.code?(t.showToast({title:"更改成功",duration:1e3}),setTimeout((function(){t.navigateBack()}),1500)):e.$comfun.Toast(n.msg,"none")}))}else t.showToast({title:"使用规则不能为空！",icon:"none"});else t.showToast({title:"使用范围不能为空！",icon:"none"});else t.showToast({title:"不可使用时间不能为空！",icon:"none"});else t.showToast({title:"打烊时间不能为空！",icon:"none"});else t.showToast({title:"营业时间不能为空！",icon:"none"});else t.showToast({title:"使用日期不能为空！",icon:"none"});else t.showToast({title:"结束时间不能为空！",icon:"none"});else t.showToast({title:"开始时间不能为空！",icon:"none"});else t.showToast({title:"代金券原价不能为空！",icon:"none"});else t.showToast({title:"支付价格不能为空！",icon:"none"})},gotoElect:function(){var e=this;t.showModal({title:"",content:"确定删除该代金券吗？",success:function(n){if(n.confirm){var i={id:e.moneyId};t.showLoading(),e.$api.deleteDaijin(i).then((function(e){t.hideLoading(),200==e.code&&(t.showToast({title:"删除成功",icon:"none",duration:1e3}),setTimeout((function(){t.navigateBack()}),1500))}))}else n.cancel&&(t.showToast({title:"操作取消",icon:"none",duration:1500}),console.log("用户点击取消"))}})}}};e.default=f}).call(this,n("543d")["default"])},"2dac":function(t,e,n){"use strict";n.r(e);var i=n("d511"),o=n("aeb6");for(var a in o)["default"].indexOf(a)<0&&function(t){n.d(e,t,(function(){return o[t]}))}(a);n("fc84");var s,u=n("f0c5"),c=Object(u["a"])(o["default"],i["b"],i["c"],!1,null,"387cf06a",null,!1,i["a"],s);e["default"]=c.exports},"3deb":function(t,e,n){"use strict";(function(t){n("6cdc");i(n("66fd"));var e=i(n("2dac"));function i(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,n("543d")["createPage"])},a707:function(t,e,n){},aeb6:function(t,e,n){"use strict";n.r(e);var i=n("06ce"),o=n.n(i);for(var a in i)["default"].indexOf(a)<0&&function(t){n.d(e,t,(function(){return i[t]}))}(a);e["default"]=o.a},d511:function(t,e,n){"use strict";var i;n.d(e,"b",(function(){return o})),n.d(e,"c",(function(){return a})),n.d(e,"a",(function(){return i}));var o=function(){var t=this,e=t.$createElement;t._self._c},a=[]},fc84:function(t,e,n){"use strict";var i=n("a707"),o=n.n(i);o.a}},[["3deb","common/runtime","common/vendor"]]]);